# 1. 配置开发机环境

## 1. 步骤

### 1. 创建开发机

① 创建开发机<img src="https://github.com/bubblefu/InternLM_Camp_md/blob/main/images/image-20240606104149757.png" alt="image-20240606104149757" style="zoom:25%;" />

② 输入名称（自选）

③ 选择Cuda11.7 conda 镜像

④ 选择10%或30%的A100资源

<img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606103922151.png" alt="image-20240606103922151" style="zoom:20%;" />

⑤ 选择运行时长 

⑥ 立即创建

<img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606103940695.png" alt="image-20240606103940695" style="zoom:20%;" />

### 2. 使用开发机

1. 点击进入开发机——jupyterlab——终端，在终端里进行操作

   <img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606104506292.png" alt="image-20240606104506292" style="zoom:25%;" />

2. 点击进入开发机——直接使用终端操作

3. 点击SSH连接， remote在自己电脑里用自己电脑的terminal来操作。这样可以不用网页。

   <img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606104551920.png" alt="image-20240606104551920" style="zoom:50%;" /><img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606104629384.png" alt="image-20240606104629384" style="zoom:50%;" />

### 3. 配置环境

1. 一键配置 studio-conda -o internlm-base -t demo
   1. 注：推荐这种方式，可以直接重置conda环境，如果你玩坏了，没有conda环境了，会重新装一个。  
   2. 注：在开发机里自己没法装conda环境，只能用装好的或者studio-conda来安装的。

2. 配置成功后会出现：

   ![image-20240606105110365](C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606105110365.png)时间大概30-45分钟。 <u>若没成功，请参考debug小节。</u>

   

## 2. debug及总结

在安装开发机并配置环境时，开发机的配置选择 和 空间占用 都会导致studio-conda 命令后最终 配置环境失败。

#### 1. 常见error 1：  studio-conda 不成功

1. ```
   InvalidArchiveError("Error with archive /root/.conda/pkgs/pip-24. 0-py310h06a4308 0. conda.You probably need to delete and re-download or re-create this file.Message was:\n\nfailedrrno 2]No such file or directory:/root/.conda/pkgs/pip-24.0-py310h06a4308 0. conda’")
   
   InvalidArchiveError("Error with archive /root/.conda/pkgs/openssl-1. 1.1w-h7f8727e 0. conda.You probably need to delete and re-download or re-create this file.Message was:\n\nfaileErrno 2No such file or directory:/root/,conda/pkgs/openssl-1.1. 1w-h7f8727e 0. conda ")
   
   
   初始化 conda环境: demo 失败 
   
   ```

出现这个问题的原因是： **<u>云盘空间没有给分配。是0</u>**。 正常会分配100G的空间给你。你可以查看下开发机控制台——我的云盘——右侧——空间容量：

如果是：那就是正常的![image-20240606111331267](C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606111331267.png)



如果是：就需要找助教开空间 ![image-20240606111410844](C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606111410844.png)

注：这个问题  容易被忽略！！  血的教训┭┮﹏┭┮



#### 2. 常见error2： conda 环境不好用了

参考QA文档，问题1，玩坏了环境后该怎么办？

即：只能重新构建开发机环境了。   conda环境没有办法自己装，只能用默认的。

#### 3. 总结

基于我的debug路径，我总结出开发机配置环境的原理：

studio-conda  安装是如何安装？

1. ~/share/文件夹里保存所有配置环境需要的packages。
2. 我们自己的conda环境在~/.conda/文件中
3. 安装过程：不断copy-paste  即从   ~/share/pkgs/     —>    ~/.conda/pkgs/ 

4. 因为：
   1. share文件夹在开发机的云服务器总机中，通过软链接能让我们在自己的终端中看到这个文件夹。     
   2. 给我们分配的100G内容，使我们自己的开发机的存储空间，在studio-conda前，就是空的。   随着安装，即安装和复制粘贴packages到我们自己空间中后，我们才能用这些模块进行模型部署。
5. 所以如果没有分配空间，不可能安装成功的。

# 2. 模型实战

## 1. 基本模型**`InternLM2-Chat-1.8B`**

### 1. 基本步骤

1. demo环境已经配置完成，进入环境中：
		conda activate demo
	
2. 安装后续的包
        pip install huggingface-hub==0.17.3
        pip install transformers==4.34 
        pip install psutil==5.9.8
        pip install accelerate==0.24.1
        pip install streamlit==1.32.2 
        pip install matplotlib==3.8.3 
        pip install modelscope==1.9.5
        pip install sentencepiece==0.1.99
    
3. 进行chat-1.8B模型的下载：
        mkdir -p /root/demo
        touch /root/demo/cli_demo.py
        touch /root/demo/download_mini.py
        cd /root/demo
    
    ![image-20240606112752476](C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606112752476.png)
    
4. 配置download_mini.py

    <img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606112925150.png" alt="image-20240606112925150" style="zoom:25%;" />

5. 配置cli_demo.py

   <img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606113005774.png" alt="image-20240606113005774" style="zoom: 25%;" />

6. ```
   python /root/demo/download_mini.py 进行模型下载
   ```

    ![image-20240606113110879](C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606113110879.png)

7. 下载成功后运行demo

   ```
   python /root/demo/cli_demo.py
   ```

8. 出现user>>> 后，可以输入内容与之对话

<img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606113245786.png" alt="image-20240606113245786" style="zoom:33%;" /><img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606113249370.png" alt="image-20240606113249370" style="zoom:33%;" />

### 2. 总结：

	1. 1.8B大模型在文字、语文、创作方面的反馈还可以。
	2. 1.8B大模型在数字计算方面的理解一般。  比如 1+1等于几，会等于2；如果问1+1 = ？  ，模型会不理解这种问的意思。
	3. 数学计算呈一定范围：65535 + 256 可以直接给出答案；655350+356就可能得不出答案了。
	4. 1.8B大模型没有记忆功能。
	5. 模型下载和加载很慢。但看B站视频还是蛮快的。



## 2. 八戒

## 3. Lagent Demo

## 4. 浦语 灵笔







<img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606093323758.png" alt="image-20240606093323758" style="zoom: 33%;" />

<img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606093440008.png" alt="image-20240606093440008" style="zoom:33%;" />

<img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606093452301.png" alt="image-20240606093452301" style="zoom:33%;" />

<img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606094056368.png" alt="image-20240606094056368" style="zoom:33%;" />

<img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606094132553.png" alt="image-20240606094132553" style="zoom:33%;" />

<img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606094237443.png" alt="image-20240606094237443" style="zoom:33%;" />![image-20240606094256654](C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606094256654.png)

![image-20240606094341045](C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606094341045.png)

<img src="C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606094607401.png" alt="image-20240606094607401" />

![image-20240606094944972](C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606094944972.png)

![image-20240606150304820](C:\Users\chai\AppData\Roaming\Typora\typora-user-images\image-20240606150304820.png)